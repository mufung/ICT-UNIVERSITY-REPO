 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>University Portal | Login</title>
    
    <script src="https://cdn.jsdelivr.net/npm/amazon-cognito-identity-js@6.0.1/dist/amazon-cognito-identity.min.js"></script>

    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .login-container { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); width: 100%; max-width: 400px; text-align: center; }
        h2 { color: #1f2937; margin-bottom: 24px; }
        input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #d1d5db; border-radius: 6px; box-sizing: border-box; font-size: 16px; }
        button { width: 100%; padding: 12px; background-color: #14b8a6; color: white; border: none; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer; transition: background 0.3s; margin-top: 10px; }
        button:hover { background-color: #0d9488; }
        button:disabled { background-color: #9ca3af; cursor: not-allowed; }
        #message { margin-top: 15px; font-size: 14px; color: #dc2626; display: none; }
    </style>
</head>
<body>

<div class="login-container">
    <h2>University Portal</h2>
    <form id="loginForm">
        <input type="email" id="email" placeholder="Email Address" required>
        <input type="password" id="password" placeholder="Password" required>
        <button type="submit" id="loginBtn">Sign In</button>
    </form>
    <div id="message"></div>
</div>

<script>
    // Your Corrected AWS Configuration
    const POOL_DATA = {
        UserPoolId: "us-west-1_mbnfq4DcV",
        ClientId: "7ugvqkg6l7859oto4v5vcjqjus" 
    };

    document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const btn = document.getElementById('loginBtn');
        const msg = document.getElementById('message');

        // Reset UI
        msg.style.display = "none";
        btn.disabled = true;
        btn.innerText = "Authenticating...";

        // Ensure Library is ready
        if (typeof AmazonCognitoIdentity === 'undefined') {
            msg.innerText = "Security library failed to load. Please refresh or try Incognito mode.";
            msg.style.display = "block";
            btn.disabled = false;
            btn.innerText = "Sign In";
            return;
        }

        const userPool = new AmazonCognitoIdentity.CognitoUserPool(POOL_DATA);
        const authDetails = new AmazonCognitoIdentity.AuthenticationDetails({
            Username: email,
            Password: password
        });
        const cognitoUser = new AmazonCognitoIdentity.CognitoUser({
            Username: email,
            Pool: userPool
        });

        // Use standard Password Auth (Fixes the SRP Error)
        cognitoUser.authenticateUser(authDetails, {
            onSuccess: function(result) {
                console.log("Login Success!");
                const accessToken = result.getAccessToken().getJwtToken();
                localStorage.setItem('userToken', accessToken);
                
                // Success redirect
                window.location.href = "dashboard_teacher.html";
            },
            onFailure: function(err) {
                console.error("Login Error:", err);
                msg.innerText = err.message || "Invalid credentials.";
                msg.style.display = "block";
                btn.disabled = false;
                btn.innerText = "Sign In";
            }
        });
    });
</script>

</body>
</html>
